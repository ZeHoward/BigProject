<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://code.jquery.com/jquery-3.7.1.js"
        integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
</head>
<script>

    window.onload = () => {
        const url = 'simple-service-webapp/webapi/db/find';
        const data = 'token=8a3abf84-78b4-4653-b1b1-534c855efd4e';
        console.log("ERROR1");


        $.post(url, data, (jsonObj) => {
            console.log("ERROR2");
            console.log(jsonObj);  // 調試：檢查後端返回的數據結構
            if (jsonObj && jsonObj.length > 0) {
                const user = jsonObj[0];
                $('#uid').text(user.uid);
                $('#cname').text(user.cname);
                $('#birthday').text(user.birthday);
            } else {
                console.error('No user data found');
            }
        }).fail((jqXHR, textStatus, errorThrown) => {
            console.error('Error: ', textStatus, errorThrown);  // 調試錯誤信息
        });

    };

    // fetch('http://localhost:8080/simple-service-webapp/webapi/db/find', {
    //     headers: {
    //         'content-type': 'application/x-www-form-urlencoded'
    //     },
    //     method: 'post',
    //     body: 'token=8a3abf84-78b4-4653-b1b1-534c855efd4e'
    // })
    //     .then(response => {
    //         if (!response.ok) {
    //             throw new Error('Network response was not ok');
    //         }
    //         // 檢查響應是否有內容
    //         return response.text().then(text => {
    //             return text ? JSON.parse(text) : {};  // 如果響應為空，返回空對象
    //         });
    //     })
    //     .then(jsonObj => {
    //         if (jsonObj && jsonObj.length > 0) {
    //             const user = jsonObj[0];
    //             const headphoto = document.getElementById('headphoto');
    //             uid.innerHTML = user.uid;
    //             cname.innerHTML = user.cname;
    //             birthday.innerHTML = user.birthday;

    //             // 如果返回了 base64 的圖片，直接設置圖片
    //             if (user.photoBase64) {
    //                 headphoto.src = `data:image/jpeg;base64,${user.photoBase64}`;
    //             } else {
    //                 console.warn('No photo available for user');
    //             }
    //         } else {
    //             throw new Error('No user information found');
    //         }
    //     })
    //     .catch(error => {
    //         console.error('Error fetching user info:', error);
    //     });



</script>

<body>
    Account: <label id="uid"></label>
    <p></p>
    Name: <label id="cname"></label>
    <p></p>
    Birthday: <label id="birthday"></label>
    <p></p>
    <img id="headphoto" width="200">
</body>

</html>